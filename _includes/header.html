<style>

  .checkout-button {
      float: right;
      margin-top:6px;
      font-size: 12px;
  }
  .title-header {
    padding:4px;
    padding-left: 12px;
    padding-bottom: 8px;
    border-bottom-left-radius:3px;
    border-bottom-right-radius:3px;
    font-family: 'Inconsolata', monospace;
    font-size: 18px;
    background: #424242;
  }
  .title-header a {
    color: #e4e4e4;
  }
  .button-transparent {
    background: transparent;
  }
  .apiuser {
    float: right;
    font-size: 14px;
    color: #9c9c9c;
    margin-right: 4px;
    margin-left: 4px;
    padding-top: 9px;
  }
  .custom-menu {
      white-space: normal;
  }
  .logo-image {
    height: 25px;
  }
  #orders-button {
    display: none;
  }
  .return-link  {
    font-size: 12px;
    font-family: 'Inconsolata', monospace;
    color: #fff;
  }

  /* The Modal (background) */
.modal {
  display: none; /* Hidden by default */
  position: fixed; /* Stay in place */
  z-index: 1; /* Sit on top */
  left: 0;
  top: 0;
  width: 100%; /* Full width */
  height: 100%; /* Full height */
  overflow: auto; /* Enable scroll if needed */
  background-color: rgb(0,0,0); /* Fallback color */
  background-color: rgba(0,0,0,0.2); /* Black w/ opacity */
}

/* Modal Content/Box */
.modal-content {
  font-family: 'Inconsolata', monospace;
  background-color: transparent;
  margin: 15% auto; /* 15% from the top and centered */
  padding: 20px;
  border: 1px solid #888;
  width: 80%; /* Could be more or less, depending on screen size */
  color: #fff;
  font-size:24px;
  border: 0px;
  text-align: center;
}

</style>

<header class="site-header" role="banner">

  <div class="wrapper">
    {%- assign default_paths = site.pages | map: "path" -%}
    {%- assign page_paths = site.header_pages | default: default_paths -%}

    <div class="title-header">
      <a href="/"><img id="logo-image" class="logo-image" src="/assets/images/logo_hangarmx_white.svg"></a>
      <a class="checkout-button pure-button button-transparent" id="login-button" href="/login"><i class="fas fa-user-plus"></i></a>
      <a class='apiuser' href="/edit_user" id='apiuser'></a>
      <a class="checkout-button pure-button button-transparent" id='orders-button' href="/orders"><i class="fas fa-receipt"></i></a>
      <a class="checkout-button pure-button button-transparent" href="/checkout"><i class="fas fa-shopping-cart"></i></a>

    </div>

    <div class="pure-menu pure-menu-horizontal custom-menu">
        <ul class="pure-menu-list">
            <li class="pure-menu-item pure-menu-has-children pure-menu-allow-hover">
                <a href="#" id="menuLink1" class="pure-menu-link">Servicios</a>
                <ul class="pure-menu-children">
                  {% for service in site.services %}
                    <li class="pure-menu-item"><a href="{{ service.url }}" class="pure-menu-link">{{ service.title }}</a></li>
                  {% endfor %}
                </ul>
            </li>
            <li class="pure-menu-item pure-menu-has-children pure-menu-allow-hover">
                <a href="#" id="menuLink1" class="pure-menu-link">Productos</a>
                <ul class="pure-menu-children">
                  {% for group in site.groups %}
                    <li class="pure-menu-item"><a href="{{ group.url }}" class="pure-menu-link">{{ group.title }}</a></li>
                  {% endfor %}
                </ul>
            </li>
        </ul>
    </div>
  </div>
</header>

<!-- The modal loading -->
<div id="myModal" class="modal">
  <div class="modal-content">
    <p>Cargando p√°gina de internet . . .<br>
    <a onclick='location.reload();' class='return-link'>(Recargar manualmente)</a>
    </p>
  </div>
</div>

<script>

  // The modal loading
  var modal = document.getElementById("myModal");
  function loading(active){
    if (active) {
      $(modal).stop().fadeIn(800);
    }else{
      $(modal).stop().fadeOut(200);
    }
  }

  var cart_token = getCookie('cart_token');
  if (cart_token == '') {
    cart_token = Math.random().toString(36);
    setCookie('cart_token', cart_token, 2);
  }

  current_user = $.Deferred()
  $(document).ready(function () {
    var session_token = getCookie('session_token')
    if (session_token != '') {
      remoteCall('user_get_current',false,false).done(function(data){
        current_user.resolve(data.user).promise();
        var username = $('#apiuser');
        username.text(data.user.name.split(' ')[0]);
        username.attr("href","/edit-user");
        login_button = $('#login-button');
        login_button.html('<i class="fas fa-user-minus"></i>');
        login_button.attr("href","#");
        login_button.click(function () {
          logout();
          $('#orders-button').css('display','none');
        });
        $('#orders-button').css('display','unset');

      }).fail(function(data){
        current_user.reject(false).promise();
        setCookie('session_token','',-1000);
      });
    }else{
      current_user.reject(false).promise();
    }
  });



</script>
