<style>
.checkout-button {
    float: right;
    padding-top: 2px;
    padding-bottom: 2px;
    padding-right: 2px;
    padding-left: 12px;
}
.title-header {
  padding:4px;
  padding-left: 12px;
  padding-bottom: 8px;
  font-family: 'Inconsolata', monospace;
  font-size: 18px;
  background: #424242;
}
.title-header a {
  color: #e4e4e4;
}
.apiuser {
  float: right;
  font-size: 14px;
  color: #9c9c9c;
  padding-right: 2px;
  padding-top: 12px;
}
.custom-menu {
    white-space: normal;
}

/* Needed for the loading css jquery animation */
.loading-image {
  width: 25px;
  height: 25px;
  -webkit-animation:spin 4s linear infinite;
  -moz-animation:spin 4s linear infinite;
  animation:spin 4s linear infinite;
}
.stop {
  -webkit-animation-play-state:paused;
  -moz-animation-play-state:paused;
  animation-play-state: paused;
}
.init-rotation {
  -webkit-transform: rotate(0deg);
  -moz-transform: rotate(0deg);
  transform: rotate(0deg);
}



@-moz-keyframes spin { 100% { -moz-transform: rotate(360deg); } }
@-webkit-keyframes spin { 100% { -webkit-transform: rotate(360deg); } }
@keyframes spin { 100% { -webkit-transform: rotate(360deg); transform:rotate(360deg); } }
/* -------------------------------------------- */

</style>

<header class="site-header" role="banner">

  <div class="wrapper">
    {%- assign default_paths = site.pages | map: "path" -%}
    {%- assign page_paths = site.header_pages | default: default_paths -%}
    <!-- <a class="site-title" rel="author" href="{{ "/" | relative_url }}">{{ site.title | escape }}</a> -->

    <div class="title-header">
    <a href="/">{{ site.title | escape }}</a>
    <img id="loading-image" class="loading-image init-rotation stop" src="/assets/images/noun_carbon.svg" alt="006 Carbon C by Joel Wisneski from the Noun Project">
    <a class='apiuser' href="/edit_user" id='apiuser'></a>
    </div>

    <div class='checkout-button'">
      <a class="pure-button" href="/"><i class="fas fa-shopping-cart"></i></a>
      <a class="pure-button" id="login_button" href="/login"><i class="fas fa-user-plus"></i></a>  <!-- <i class="fas fa-user-minus"></i> -->
    </div>

    <div class="pure-menu pure-menu-horizontal custom-menu">
        <ul class="pure-menu-list">
            <li class="pure-menu-item pure-menu-has-children pure-menu-allow-hover">
                <a href="#" id="menuLink1" class="pure-menu-link">Services</a>
                <ul class="pure-menu-children">
                  {% for service in site.services %}
                    <li class="pure-menu-item"><a href="{{ service.url }}" class="pure-menu-link">{{ service.title }}</a></li>
                  {% endfor %}
                </ul>
            </li>
            <li class="pure-menu-item pure-menu-has-children pure-menu-allow-hover">
                <a href="#" id="menuLink1" class="pure-menu-link">Products</a>
                <ul class="pure-menu-children">
                  {% for product in site.products %}
                    <li class="pure-menu-item"><a href="{{ service.url }}" class="pure-menu-link">{{ product.title }}</a></li>
                  {% endfor %}
                </ul>
            </li>
        </ul>
    </div>
  </div>
</header>

<script>

  current_user = $.Deferred();



  $(document).ready(function () {
    var session_token = getCookie('session_token')
    if (session_token == '') { return false };
    gapi.load('auth2', function() {
      gapi.auth2.init({client_id:"19912403518-umth3iha0k0qltfeul122n08u49q9pjs.apps.googleusercontent.com"});
    });
    getUser().done(function(user){
      if (user) {
        current_user.resolve(user);
        var username = $('#apiuser');
        username.text(user.name.split(' ')[0]);
        username.attr("href","/edit-user");
        login_button = $('#login_button');
        login_button.html('<i class="fas fa-user-minus"></i>');
        login_button.attr("href","#");
        login_button.click(function () {
        	// var auth2 = gapi.auth2.getAuthInstance();
        	// auth2.signOut().then(function () {
        	// 	console.log('User signed out.');
        	// });
          logout();
        });

      }else{
        current_user.reject();
      };

    })
  });
</script>
